C51 COMPILER V9.01   UART_485                                                              08/18/2021 17:34:46 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE UART_485
OBJECT MODULE PLACED IN .\Objects\UART_485.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE ..\BSP\BSP_485\UART_485.C LARGE WARNINGLEVEL(1) OPTIMIZE(8,SPEED) BROWSE
                    - INCDIR(..\USER;..\SYS;..\BSP\BSP_485;..\BSP\BSP_ADC;..\BSP\BSP_KEY;..\BSP\BSP_OLED_IIC;..\APP;..\BSP\BSP_IO) DEBUG OBJE
                    -CTEXTEND PRINT(.\Listings\UART_485.lst) TABS(2) OBJECT(.\Objects\UART_485.obj)

line level    source

   1          /*
   2           * @Author: your name
   3           * @Date: 2021-04-30 09:38:30
   4           * @LastEditTime: 2021-05-13 08:54:32
   5           * @LastEditors: Please set LastEditors
   6           * @Description: In User Settings Edit
   7           * @FilePath: \AirPressControl\BSP\BSP_485\UART_485.C
   8           */
   9          
  10          
  11          #include "CH551.H"                                                          
  12          #include "Debug.H"
  13          #include "UART_485.H"
  14          #include "OLED_IIC.h"
  15          
  16          void UART0Alter()
  17          {
  18   1          PIN_FUNC |= bUART0_PIN_X;                                                  //ï¿½ï¿½ï¿½ï¿½Ó³ï¿½äµ½P1.2ï
             -¿½ï¿½P1.3
  19   1      }
  20          /*******************************************************************************
  21          * Function Name  : CH554UART0RcvByte()
  22          * Description    : CH554UART0æŽ¥æ”¶ä¸€ä¸ªå­—èŠ‚
  23          * Input          : None
  24          * Output         : None
  25          * Return         : SBUF
  26          *******************************************************************************/
  27          UINT8 DATA;
  28          UINT8  UART0RcvByte( )
  29          {
  30   1          // while(RI == 0);                                                            //æŸ¥è¯¢æŽ¥æ”¶ï¼Œä¸­æ–­æ
             -–¹å¼å¯ä¸ç”¨
  31   1          // RI = 0;
  32   1          // DATA=SBUF;
  33   1          // return DATA;
  34   1          if(RI)
  35   1          {
  36   2          DATA=SBUF;
  37   2          return DATA;
  38   2          RI=0;
  39   2          }
  40   1          else
  41   1          {
  42   2          return 0;
  43   2          }
  44   1      }
  45          
  46          /*******************************************************************************
  47          * Function Name  : CH554UART0SendByte(UINT8 SendDat)
  48          * Description    : CH554UART0å‘é€ä¸€ä¸ªå­—èŠ‚
  49          * Input          : UINT8 SendDatï¼›è¦å‘é€çš„æ•°æ®
  50          * Output         : None
  51          * Return         : None
C51 COMPILER V9.01   UART_485                                                              08/18/2021 17:34:46 PAGE 2   

  52          *******************************************************************************/
  53          void UART0SendByte(UINT8 SendDat)
  54          {
  55   1          if(TI)
  56   1          {
  57   2        SBUF = SendDat;
  58   2          TI = 0; 
  59   2          }                                                            //æŸ¥è¯¢å‘é€ï¼Œä¸­æ–­æ–¹å¼å¯ä¸ç”¨ä¸‹
             -é¢2æ¡è¯­å¥,ä½†å‘é€å‰éœ€TI=0
  60   1        // while(TI ==0);
  61   1        // TI = 0;
  62   1          // SBUF = SendDat;  
  63   1      }
  64          
  65          #if UART0_INTERRUPT
              /*******************************************************************************
              * Function Name  : UART0Interrupt(void)
              * Description    : UART0 ï¿½Ð¶Ï·ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½
              *******************************************************************************/
              void UART0Interrupt( void ) interrupt INT_NO_UART0 using 1                      //ï¿½ï¿½ï¿½ï¿½1ï¿½Ð¶Ï·ï¿½ï
             -¿½ï¿½ï¿½ï¿½ï¿½,Ê¹ï¿½Ã¼Ä´ï¿½ï¿½ï¿½ï¿½ï¿½1
              {
                UINT8 dat;
                  
                if(RI)
                {
                  DATA= SBUF;
                      RI = 0;
                      SBUF=DATA;
                      while(!TI);
                      TI = 0;
                }
                  SBUF=DATA;
              }
              
              #endif
  86          
  87          /**
  88           * @description: 
  89           * @param {UINT8} id
  90           * @return {*}
  91           */
  92          UINT8 MsgAnalyze(UINT8 id)
  93          {
  94   1          UINT8 cmd;
  95   1          RI=0;
  96   1          DATA=SBUF;
  97   1          if(id==((DATA&0X3C)>>2))
  98   1          {
  99   2              cmd=DATA&0x03;
 100   2              return cmd;
 101   2          }
 102   1          else
 103   1          {
 104   2              return 0;
 105   2          }
 106   1      }
 107          
 108          /**
 109           * @description: 
 110           * @param {*}
 111           * @return {*}
C51 COMPILER V9.01   UART_485                                                              08/18/2021 17:34:46 PAGE 3   

 112           */
 113          void MsgClear()
 114          {
 115   1          DATA=0;
 116   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     60    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      1    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
